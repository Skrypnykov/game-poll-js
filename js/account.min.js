import{URL}from"./constants.js";import{rating}from"./rating.min.js";import setData from"./setData.min.js";const result=document.getElementById("result"),accountForm=document.getElementById("accountForm"),userBall=document.getElementById("ball"),startButton=document.getElementById("go"),userLocalData=localStorage.getItem("userData");userLocalData||(location.href="/");let userData=JSON.parse(userLocalData);$(function(){$("#phone").mask("+38 (0**) ***-**-**")});const chngForm=a=>{const b=a?a:userData;b&&(accountForm.elements[0].value=b.nickname,accountForm.elements[1].value=b.fullname,accountForm.elements[2].value=b.organization,accountForm.elements[3].value=b.position,accountForm.elements[4].value=b.phone,userBall.innerText=b.score)},chngButton=a=>{result.innerText=a.rated?"\u041D\u0435 \u0432\u0456\u0434\u043E\u0431\u0440\u0430\u0436\u0430\u0442\u0438 \u043C\u043E\u0457 \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u0438 \u0432 \u0437\u0430\u0433\u0430\u043B\u044C\u043D\u043E\u043C\u0443 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0443":"\u0412\u0456\u0434\u043E\u0431\u0440\u0430\u0436\u0430\u0442\u0438 \u043C\u043E\u0457 \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u0438 \u0432 \u0437\u0430\u0433\u0430\u043B\u044C\u043D\u043E\u043C\u0443 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0443"};accountForm.addEventListener("submit",function(a){const b=localStorage.getItem("userId"),c=localStorage.getItem("token");a.preventDefault();const d=Array.from(a.target);let e={};if(c&&b){d.forEach(a=>{a.id&&(e[a.id]=a.value)}),e.rated=userData.rated,setData(URL+"users/"+b,c,e).then(a=>{userData=JSON.parse(localStorage.getItem("userData"));const b=a?a:userData;chngForm(b),chngButton(b),rating()}).catch(a=>console.log(a))}}),result.addEventListener("click",()=>{const a=localStorage.getItem("userId"),b=localStorage.getItem("token");if(b&&a){const c={rated:!userData.rated};setData(URL+"users/"+a,b,c).then(a=>{userData=JSON.parse(localStorage.getItem("userData"));const b=a?a:userData;chngButton(b),rating()}).catch(a=>console.log(a))}}),startButton.addEventListener("click",()=>location.href="./question.html"),chngForm(userData),chngButton(userData);